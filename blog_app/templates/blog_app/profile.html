{% extends "base.html" %}
{% block title %}Profile{% endblock %}
{% block content %}

<div class="container my-5">

  <!-- HEADER -->
  <div class="text-center mb-5">
    <h2 class="fw-light mb-2">Creator Dashboard</h2>
    <p class="text-muted mb-0">
      Logged in as <strong>{{ request.user.username }}</strong>
    </p>
    <hr class="mt-4">
  </div>

  <!-- ===================== -->
  <!-- DRAFT POSTS -->
  <!-- ===================== -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="fw-light mb-0">Draft Posts</h3>
    <span class="badge bg-secondary">{{ drafts|length }}</span>
  </div>

  <div class="row g-4 mb-5">
    {% for post in drafts %}
      <div class="col-12 col-md-6 col-lg-4">

        <!-- EXACT style as index -->
        <div class="post-card p-4 h-100 d-flex flex-column">

          {% if post.post_image and post.post_image != "placeholder" %}
            <div class="post-image-wrapper mb-3">
              <img src="{{ post.post_image.url }}"
                   class="img-fluid post-image"
                   alt="{{ post.title }}">
            </div>
          {% else %}
            <div class="text-muted small mb-3">
              No image uploaded for this draft.
            </div>
          {% endif %}

          <h5 class="mb-2">{{ post.title }}</h5>

          <div class="text-muted small">
            {{ post.content|truncatewords:20|safe }}
          </div>

          <div class="mt-auto pt-3 text-center">
            <a href="{% url 'blog:update_post' post.pk %}"
               class="btn btn-sm btn-dark me-2">
              Edit
            </a>
            <a href="{% url 'blog:delete_post' post.id %}"
               class="btn btn-sm btn-dark">
              Delete
            </a>
          </div>

        </div>

      </div>
    {% empty %}
      <div class="col-12">
        <div class="alert alert-light border text-center">
          No draft posts available.
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- ===================== -->
  <!-- PUBLISHED POSTS -->
  <!-- ===================== -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="fw-light mb-0">Published Posts</h3>
    <span class="badge bg-dark">{{ published|length }}</span>
  </div>

  <div class="row g-4 mb-5">
    {% for post in published %}
      <div class="col-12 col-md-6 col-lg-4">

        <!-- EXACT style as index -->
        <div class="post-card p-4 h-100 d-flex flex-column">

          {% if post.post_image and post.post_image != "placeholder" %}
            <div class="post-image-wrapper mb-3">
              <a href="{% url 'blog:post_detail' post.slug %}">
                <img src="{{ post.post_image.url }}"
                     class="img-fluid post-image"
                     alt="{{ post.title }}">
              </a>
            </div>
          {% else %}
            <div class="text-muted small mb-3">
              No image uploaded for this post.
            </div>
          {% endif %}

          <h5 class="mb-2">
            <a href="{% url 'blog:post_detail' post.slug %}"
               class="text-decoration-none text-dark">
              {{ post.title }}
            </a>
          </h5>

          <div class="text-muted small">
            {{ post.content|truncatewords:20|safe }}
          </div>

          <div class="mt-auto pt-3 text-center">
            <a href="{% url 'blog:post_detail' post.slug %}"
               class="btn btn-sm btn-dark me-2">
              View
            </a>
            <a href="{% url 'blog:update_post' post.pk %}"
               class="btn btn-sm btn-dark me-2">
              Edit
            </a>
            <a href="{% url 'blog:delete_post' post.id %}"
               class="btn btn-sm btn-dark">
              Delete
            </a>
          </div>

        </div>

      </div>
    {% empty %}
      <div class="col-12">
        <div class="alert alert-light border text-center">
          No published posts available.
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- ===================== -->
  <!-- AUTH BUTTON -->
  <!-- ===================== -->
  <div class="text-center">
    <form action="{% url 'account_logout' %}" method="post">
      {% csrf_token %}
      <button type="submit" class="btn btn-dark btn-sm">
        Logout
      </button>
    </form>
  </div>

</div>

{% endblock %}